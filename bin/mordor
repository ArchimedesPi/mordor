#!/bin/bash
# Mordor
# Licensed 3-Clause BSD

set -e # Terminate if things go badly. This prevents
# critical operations from being preformed on incomplete data

# Functions to clean paths

function absolute_path() {
	local dirty_path="$1"
	pushd "$dirty_path" > /dev/null
	local clean_path=`pwd -P`
	popd > /dev/null

	echo "$clean_path"
}

function absolute_file_folder() {
	local dirty_folder_path=`dirname $1`
	echo `absolute_path $dirty_folder_path`
}

# Set some global variables for the script
BASEDIR=`absolute_file_folder $BASH_SOURCE`
LIBDIR=`absolute_path "${BASEDIR[0]}/../lib/"`
VERSION="0.1"

# Grab all the libraries

. $LIBDIR/colors.sh
. $LIBDIR/logging.sh

_info "$(_bg_color $_yellow)$(_color $_magenta)\$\$\$${_reset_formatting}$(_bg_color $_yellow)_-_-_-_$_reset_formatting $(_color $_red)Mordor$_reset_formatting $(_color $_blue)$VERSION$_reset_formatting $(_bg_color $_yellow)_-_-_-_$(_color $_magenta)\$\$\$$_reset_formatting"

cmd="$1"

if [[ ! $cmd ]]; then
	exit
fi

# Source the command invoked
case $cmd in
	*)	source $LIBDIR/commands/$cmd.sh # If it's not a special case and it falls through...
esac
